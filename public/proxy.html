<!doctype html>
<html>
    <head>
        <style>
            /* Add a black background color to the top navigation */
            .topnav {
            background-color: #333;
            overflow: hidden;
            }

            /* Style the links inside the navigation bar */
            .topnav a {
            float: left;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
            }

            /* Change the color of links on hover */
            .topnav a:hover {
            background-color: #ddd;
            color: black;
            }

            /* Add a color to the active/current link */
            .topnav a.active {
            background-color: #04AA6D;
            color: white;
            }
        </style>
        <script src="/uv/uv.bundle.js"></script>
        <script src="/uv/uv.config.js"></script>
        <script src="/baremux/index.js"></script>
        <script>
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                navigator.serviceWorker.register("/uv/sw.js");
            });
        }
        </script>
    </head>
    <body>
        <div class="topnav">
            <a href="index.html"><img src="./image/logo.png" height="30px" style="display: inline-block;"></a>
            <a href="games.html">Games</a>
            <a href="proxy.html">Proxy</a>
            <a href="about.html">About</a>
        </div>
        <input type="text" id="urlInput" placeholder="Enter URL here">
        <button id="searchButton">Search Text</button>
        <iframe id="iframeWindow" class="iframeWindow"></iframe>
        <script>
            const connection = new BareMux.BareMuxConnection("/baremux/worker.js")
            const wispUrl = (location.protocol === "https:" ? "wss" : "ws") + "://" + location.host + "/wisp/";
            const bareUrl = (location.protocol === "https:" ? "https" : "http") + "://" + location.host + "/bare/"
            document // makes it so you can press enter to submit as opposed to just being able to press a button
                .getElementById("urlInput")
                .addEventListener("keydown", function (event) {
                    if (event.key === "Enter") {
                        event.preventDefault();
                        document.getElementById("searchButton").click();
                    }
                });

            document.getElementById("searchButton").onclick = async function (event) {
                event.preventDefault();

                let url = document.getElementById("urlInput").value; // if no periods are detected in the input, search google instead
                let searchUrl = "https://www.google.com/search?q=";

                if (!url.includes(".")) {
                    url = searchUrl + encodeURIComponent(url);
                } else {
                    if (!url.startsWith("http://") && !url.startsWith("https://")) { // if no http or https is detected, add https automatically
                        url = "https://" + url;
                    }
                }
                if (!await connection.getTransport()) {
                    await connection.setTransport("/epoxy/index.mjs", [{ wisp: wispUrl }]);
                }
                iframeWindow.src = __uv$config.prefix + __uv$config.encodeUrl(url);
            };
        </script>
    </body>
</html>